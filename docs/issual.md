# 实现 TODO 细项

## 章节与资源管理器
- [x] 章节/卷结构持久化（本地 JSON -> API）
- [x] 章节树拖拽（原生 Drag & Drop）
- [x] 章节批量操作（复制/合并/移动）
- [x] 章节元数据编辑（状态、标签、更新时间）

## 编辑器与块操作
- [x] BlockNote 侧边块菜单改造（插入 AI 按钮）
- [x] 块级选中范围 API 抽象（文本/多块）
- [x] 块级 AI 操作结果写回并保留历史（AI 日志）
- [x] 块内 AI 操作入口（移除右侧块级入口）
- [x] 块级 AI 动作提示词可配置

## AI Provider
- [x] Provider schema 校验（URL/token/model）
- [x] 请求适配 OpenAI 兼容格式
- [x] 请求超时/重试/限流处理
- [x] 统一错误提示与日志面板
- [x] Provider 模型列表自动拉取与选择（支持缓存与错误反馈）
- [x] Provider 可用性测试入口（在设置面板中校验配置并显示结果）
- [x] Provider 拼接地址显示（默认 /v1/，# 结尾不拼接）
- [x] Provider 真实可用性 E2E（默认使用设置中的 Provider）

## 用户系统（隔离）
- [x] 后端用户注册/登录/会话接口（Token）
- [x] 数据按用户隔离存储（每用户独立 DB）
- [x] 客户端持久化 token/user 并在请求头携带 Authorization
- [x] 设置面板提供“账号/工作空间”入口（查看/退出/切换）
- [x] 工作区清空入口（删除章节/资料/AI 记录）
- [x] 默认不保留旧数据，不做旧库迁移（新用户空库）
- [x] 单元/集成/E2E 测试覆盖隔离场景（登录/跨用户隔离）

## Agent
- [x] Agent 配置与运行策略（串行）
- [x] Agent 上下文拼装（章节/标签）
- [x] Agent 结果结构化输出
- [x] Agent 运行记录与可复现输入

## 设定与资料库
- [x] 角色卡字段（基础结构）
- [x] 世界观条目与引用
- [x] 章节引用设定片段
- [x] 资料库独立页面与引用插入
- [x] 资料库新建失败原因定位 + 交互补全（loading/error/log）
- [x] 角色/地点卡片式展示与 AI 生成填写

## 导出与分享
- [x] Markdown/HTML/TXT 导出
- [x] 发布预览页

## 测试与回归
- [x] 真实点击回归覆盖矩阵与追踪表（RegressionCoverageMatrix/Tracking）
- [x] 真实反馈验收规则（RealFeedbackRules）
- [x] E2E 环境编排与数据重置规范（E2EEnvironment + reset）
- [x] 测试重置安全护栏（仅允许 e2e/tmp 数据目录）
- [x] E2E 使用独立端口与数据目录，避免测试重置影响默认数据库

## 基础能力
- [x] 自动保存与冲突处理
- [x] 本地离线缓存与恢复
- [x] 版本历史与差异对比
- [x] 主题切换与字体配置
- [x] 统一设置面板与全量配置入口整合
- [x] 测试体系（smoke / unit / e2e）与 CI 运行指引
- [x] 代码结构拆分，保证单文件 <1000 行
- [x] 开发模式默认 LAN 访问（Vite host + API base 动态解析）
